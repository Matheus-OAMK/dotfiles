set -g default-terminal "tmux-256color"
set -ga terminal-overrides ',xterm-256color:Tc'

set-option -g status-position top

# Change prefix key to Ctrl-a
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# To refresh tmux config
unbind r
bind r source-file ~/.config/tmux/tmux.conf

# vim motions when select mode
set-window-option -g mode-keys vi

set -g mouse on

unbind -T copy-mode-vi MouseDragEnd1Pane # don't exit copy mode when dragging with mouse

bind-key -T copy-mode-vi 'v' send -X begin-selection # start selecting text with "v"
bind-key -T copy-mode-vi 'y' send -X copy-selection # copy text with "y"

set -g base-index 1 # Start windows index from 1 (default 0)
set -g renumber-windows on # Renumber windows when closing

# Faster resizing
bind -r Down  resize-pane -D 5
bind -r Up    resize-pane -U 5
bind -r Right resize-pane -R 5
bind -r Left  resize-pane -L 5


bind -r m resize-pane -Z # Maximize window with "m"

# Change splitting
unbind %
bind | split-window -h -c "#{pane_current_path}"
unbind '"'
bind - split-window -v -c "#{pane_current_path}"

bind c new-window -c "#{pane_current_path}" # Uses current path as default when opening a new window



# Plugin manager
set -g @plugin "tmux-plugins/tpm"
# List of plugins
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin "christoomey/vim-tmux-navigator"
set -g @plugin "tmux-plugins/tmux-battery"
set -g @plugin "Matheus-OAMK/tmux-sysmon"

# Leave commented out for now --------
# set -g @plugin 'tmux-plugins/tmux-resurrect' # persist tmux sessions after computer restart
# set -g @plugin 'tmux-plugins/tmux-continuum' # automatically saves sessions for you every 15 minutes
# set -g @resurrect-capture-pane-contents 'on'
# set -g @continuum-restore 'on'
# -----------------


set -g status-style "default"
set -g status-justify "absolute-centre"

# Colors
set -gq @thm_dynamic "colour4" 
set -gq @thm_red "#f38ba8"
set -gq @thm_yellow "#f9e2af"
set -gq @thm_lavender "#b4befe"
set -gq @thm_subtext_0 "#bac2de"
set -gq @thm_overlay_0 "#585b70"
set -gq @thm_gray_dark "#313244"
set -gq @thm_crust "#11111b"


# status left look and feel
set -g status-left-length 100
set -g status-left ""
set -ga status-left "#{?client_prefix,#{#[fg=#{@thm_red},bold]  #S },#{#[fg=#{@thm_subtext_0}, bold]  #S }}"
set -ga status-left "#[bg=default,fg=#{@thm_overlay_0}]│"
set -ga status-left "#[bg=default,fg=#{@thm_subtext_0}]  #{=/-32/...:#{s|$USER|~|:#{b:pane_current_path}}} "
set -ga status-left "#[bg=default,fg=#{@thm_overlay_0}]#{?window_zoomed_flag,│,}"
set -ga status-left "#[bg=default,fg=#{@thm_yellow}]#{?window_zoomed_flag, 󰁌 zoom ,}"


# status right look and feel
set -g status-right-length 100
set -g status-right ""
# Test tmux own plugin
set -ga status-right "#[bg=default,fg=#{@thm_subtext_0}]  #{cpu} "
set -ga status-right "#[bg=default,fg=#{@thm_overlay_0}]│"
set -ga status-right "#[bg=default,fg=#{@thm_subtext_0}]  #{mem} "


# messages
set -g message-style "fg=#{@thm_dynamic},bg=default,align=centre"
set -g message-command-style "fg=#{@thm_dynamic},bg=default,align=centre"


# menu
set -g menu-selected-style "fg=#{@thm_fg},bold,bg=#{@thm_overlay_0}"

# pane border look and feel (splits)
setw -g pane-border-status top
setw -g pane-border-format ""
setw -g pane-active-border-style "bg=default,fg=#{@thm_overlay_0}"
setw -g pane-border-style "bg=default,fg=#{@thm_gray_dark}"

# popups
set -g popup-style "bg=#{@thm_crust}, fg=#{@thm_subtext_0}"
set -g popup-border-style "fg=#{@thm_crust}, bg=#{@thm_crust}"

# Mode (like session selector, when copying, and clock)
set -g mode-style "fg=#{@thm_crust}, bg=#{@thm_dynamic}"


# window look and feel
set -wg automatic-rename on
set -g automatic-rename-format "Window"

# window status
set -gq window-status-activity-style "bg=#{@thm_lavender},fg=#{@thm_crust}" # When any print happens on innavtice window
set -gq window-status-bell-style "bg=#{@thm_yellow},fg=#{@thm_crust}," # when prints '\a' on innactive window
set -gqF window-status-separator "#[bg=default,fg=#{@thm_overlay_0}]│"

set -gq @w_text "#{?#{!=:#{window_name},Window}, #W,}"
set -gq @w_number "#I"
set -gq @w_flags "#{?window_activity_flag, 󱅫,}#{?window_bell_flag, 󰂞,}#{?window_silence_flag, 󰂛,}#{?window_marked_flag, 󰃀,}#{?window_zoomed_flag, 󰁌,}"
set -g @number_style "#[bg=default]"

# Innactice window style
set -gq @thm_left_separator " "
set -gq @thm_right_separator " "

set -gF window-status-format \
  "#{@thm_left_separator}#{@number_style}#{@w_number}"
set -agF window-status-format \
  "#{@w_text}#{@w_flags}#{@thm_right_separator}"
 
# Active window style
set -gq @thm_active_left_separator "#[fg=#{@thm_dynamic}, bg=default] #[none]"
set -gq @thm_active_right_separator "#[fg=#{@thm_dynamic} bg=default] "
set -gq @active_number_style "#[fg=#{@thm_crust},bg=#{@thm_dynamic}, bold]"

set -gF window-status-current-format \
  "#{E:@thm_active_left_separator}#{E:@active_number_style}#{@w_number}"
set -gaF window-status-current-format \
  "#{@active_number_style}#{@w_text}#{@w_flags}#{@thm_active_right_separator}"


run "~/.config/tmux/plugins/tpm/tpm" # Keep this line at the bottom
